# Пайплан подготовки данных и обучения для задачи детекции людей с дронов.
1) Файл `data_slicing.ipynb` -- ноутбук с пайплайном подготовки данных. Исходные данные имеют большой размер и не могут быть напрямую поданы в нейросеть. Целесообразным является произвести нарезку изображений на изображения меньшего размера с перекрытиями. Для этого была выбрана библиотека `sahi`. Код производит нарезку изображений на тайлы размером 640x640 с перекрытием 0.2 и сохраняет отношение положительных изображений (те, на которых есть люди) к отрицательным (те, на которых нет людей), как 3 : 1.
2) Файл `yolov8m-4.ipynb` -- ноутбук с пайплайном обучения модели yolov8m на уже нарезанных изображениях. Модель получает пути к файлам train.txt и val.txt (которые предварительно были созданы по уже нарезанным изображениям) и начинает обучение. Также, были использованы разлияные аугментации. Все параметры обучения задаются переменной `HYP`. Также, в ноутбуке есть реализованная функция расчета целевой метрики.
3) Файл `solution.py` -- файл, содержащий логику инференса модели. На вход приходит массив изображений. Внутри происходит нарезка, аналогичная нарезке при обучении. Затем, модель применяется к каждому изображению и результат агрегирует в один, относительно исходного большого изображения. Также, сделана обработка случая предсказания нескольких bbox'ов в одно место.